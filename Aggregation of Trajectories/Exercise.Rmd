# AGGREGATION OF TRAJECTORIES

-------------

## Homework

* Use trajectory aggregation to describe how Holger's cycling differs from mine
* Comparisons can be qualitative (visual) or quantitative (numeric)

```{r}
require(trajectories)
require(spacetime)
require(maptools)
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jre7')
require(OpenStreetMap)
require(ggplot2)
require (rgdal)
require (maptools)
require(plotKML)

## Holger's Cycle Tracks

getTr <- function (file) {
  tr <- readGPX (file)
  tr <- tr$tracks[[1]][[1]]
  crs <- CRS ("+proj=longlat")
  sp <- SpatialPoints (tr[,1:2], crs)
  t <- as.POSIXct(strptime(tr$time, "%Y-%m-%dT%H:%M:%SZ"))
  stidf <- STIDF (sp, t, data.frame (tr$ele))
  as (stidf, "Track")
}
vec <- vector()
ddir <- "dat/gpx-tracks/"
files <- list.files (ddir)
files <- as.character (sapply (files, function (x) paste (ddir, x, sep="")))
runs <- rides1 <- list ()
for (f in files) {
  cat (f, "\n")
  tr <- getTr (f)
  if (length (grep ("Running", f)) > 0) 
  {
  runs <- c (runs, tr)
  }
  else
  {
  rides1 <- c (rides1, tr)
  }
}

holger <- TracksCollection(list(rides1=Tracks(rides1)))
plot(holger, col="red")

## Mark's Cycle Tracks

getTr <- function (file) {
    tr <- readGPX (file)
    tr <- tr$tracks[[1]][[1]]
    crs <- CRS ("+proj=longlat")
    sp <- SpatialPoints (tr[,1:2], crs)
    t <- as.POSIXct(strptime(tr$time, "%Y-%m-%dT%H:%M:%OSZ"))
    stidf <- STIDF (sp, t, data.frame (tr$ele))
    as (stidf, "Track")
  }


ddir <- "dat/gpx-tracks-mp/"
files <- list.files (ddir)
files <- as.character (sapply (files, function (x) paste (ddir, x, sep="")))
rides2 <- list ()
for (f in files) {
  cat (f, "\n")
  rides2 <- c (rides2, getTr (f))
}
mark <- TracksCollection (list (rides2=Tracks (rides2)))
plot (mark, col="blue", lwd=1)

```

---


<span style="color:green"; font-size:2em>
Answer here
</span>

-----